#! python

import os



def build(ctx):

    def out_data(*args):
        return ctx.path_to(ctx, 'OUT_DATA', *args)

    def out_models(*args):
        return ctx.path_to(ctx, 'OUT_MODEL_SPECS', *args)

    def out_analysis(*args):
        return ctx.path_to(ctx, 'OUT_ANALYSIS', *args)

    abspath = os.path.join(ctx.path.abspath(), 'test_transition.py')

    ctx(
        features='run_py_script',
        source='test_transition.py',
        deps='transition.py',
        append=abspath
    )
    ctx.add_group()
    
    ctx(
        features = 'run_py_script',
        source = 'prepare_data.py',
        target = [
                    out_analysis('meas_fac1.pkl'),
                    out_analysis('meas_fac2.pkl'),
                    out_analysis('meas_fac3.pkl')
                 ]
        #deps=[
        #         out_data('tables','data_table_1.dta'),
        #         out_data('tables','data_table_2.dta'),
       #          out_data('tables','data_table_3.dta')
        #    ]
    )

    ctx(
        features='run_py_script',
        source='particle_smoother.py',
        target=[
            out_analysis('log', 'particle_smoother.log')
        ],
        deps = [
                    out_analysis('meas_fac1.pkl'),
                    out_analysis('meas_fac2.pkl'),
                    out_analysis('meas_fac3.pkl')
               ]
    )
    


   
